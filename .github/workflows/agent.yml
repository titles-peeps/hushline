name: Agent Automation (MVP)
on:
  issues:
    types: [labeled]
jobs:
  run-agent:
    if: ${{ github.event.label.name == 'agent' }}
    runs-on: self-hosted
    permissions:
      contents: write
      issues: write
      pull-requests: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Ensure jq and Python exist
        run: |
          command -v jq >/dev/null 2>&1 || { echo "jq required"; exit 1; }
          command -v python3 >/dev/null 2>&1 || { echo "python3 required"; exit 1; }
      - name: Run MVP agent (no LLM; FILE blocks only)
        env:
          AGENT_TOKEN: ${{ secrets.AGENT_TOKEN }}
        run: |
          bash ops/agent.sh
